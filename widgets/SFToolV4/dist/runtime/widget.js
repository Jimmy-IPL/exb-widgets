System.register(["jimu-core","jimu-arcgis"],(function(e,t){var n={},o={};return Object.defineProperty(o,"__esModule",{value:!0}),{setters:[function(e){n.React=e.React,n.jsx=e.jsx},function(e){Object.keys(e).forEach((function(t){o[t]=e[t]}))}],execute:function(){e((()=>{var e,t,r,s,a={686:e=>{"use strict";e.exports=o},244:e=>{"use strict";e.exports=n}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e].call(n.exports,n,n.exports,l),n.exports}l.m=a,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var r=Object.create(null);l.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&o&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,l.d(r,s),r},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,n)=>(l.f[n](e,t),t)),[])),l.u=e=>{if("vendors-node_modules_plotly_js-dist-min_plotly_min_js"===e)return"widgets/chunks/vendors-node_modules_plotly_js-dist-min_plotly_min_js.js"},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},s="exb-client:",l.l=(e,t,n,o)=>{if(r[e])r[e].push(t);else{var a,i;if(void 0!==n)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==s+n){a=d;break}}a||(i=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,l.nc&&a.setAttribute("nonce",l.nc),a.setAttribute("data-webpack",s+n),a.src=e),r[e]=[t];var p=(t,n)=>{a.onerror=a.onload=null,clearTimeout(h);var o=r[e];if(delete r[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(n))),t)return t(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),i&&document.head.appendChild(a)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="",(()=>{var e={"widgets/SFToolV4/dist/runtime/widget":0};l.f.j=(t,n)=>{var o=l.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=r);var s=l.p+l.u(t),a=new Error;l.l(s,(n=>{if(l.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,o[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,r,[s,a,i]=n,u=0;if(s.some((t=>0!==e[t]))){for(o in a)l.o(a,o)&&(l.m[o]=a[o]);if(i)i(l)}for(t&&t(n);u<s.length;u++)r=s[u],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkexb_client=self.webpackChunkexb_client||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var u={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(u),l.d(u,{__set_webpack_public_path__:()=>i,default:()=>a});var e=l(244),t=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function a(e){try{l(o.next(e))}catch(e){s(e)}}function i(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}l((o=o.apply(e,t||[])).next())}))};const n="https://mygishub.interpipeline.com/notebook/rest/services/8d125aad8152431282c8285bad359241/GPServer/SFWebToolTest",o=e=>new Promise((t=>setTimeout(t,e)));function r(e,t,n){if(n<=1)return[e];const o=(t-e)/(n-1),r=[];for(let t=0;t<n;t++)r.push(e+o*t);return r}function s(e){var t,n;const o=e.split(":");return(Number(null!==(t=o[0])&&void 0!==t?t:0)+Number(null!==(n=o[1])&&void 0!==n?n:0)/60)/12*Math.PI*2+Math.PI/2}function a(a){const i=e.React.useRef(null),[u,c]=e.React.useState("demo_ls"),[d,p]=e.React.useState("demo_weld"),[h,f]=e.React.useState("100"),[m,y]=e.React.useState("idle"),[v,b]=e.React.useState(""),g=e.React.useRef(null);function _(e){return t(this,void 0,void 0,(function*(){const n=yield function(){return t(this,void 0,void 0,(function*(){var e;if(g.current)return g.current;const t=yield l.e("vendors-node_modules_plotly_js-dist-min_plotly_min_js").then(l.t.bind(l,708,23));return g.current=null!==(e=null==t?void 0:t.default)&&void 0!==e?e:t,g.current}))}();if(!i.current)return;const{traces:o,layout:a}=function(e){var t,n;const o=null!==(t=e.title)&&void 0!==t?t:"SleeveFinder Plot",a="number"==typeof e.radius?e.radius:1,i="number"==typeof e.sw_thickness?e.sw_thickness:.15,l="number"==typeof e.label_angle_deg?e.label_angle_deg:90,u="number"==typeof e.label_offset_factor?e.label_offset_factor:1.15,c=Array.isArray(e.data)?e.data:[],d=Array.isArray(e.data_gw)?e.data_gw:[],p=Array.isArray(e.data_sw)?e.data_sw:[],h=[],f=[],m=[];for(const[e,t]of c){const n=s(t);h.push(e),f.push(a*Math.cos(n)),m.push(a*Math.sin(n))}const y=[];if(h.length&&y.push(Math.min(...h),Math.max(...h)),d.length){const e=d.map((e=>e[0]));y.push(Math.min(...e),Math.max(...e))}if(p.length){const e=p.map((e=>e[0])),t=p.map((e=>e[1]));y.push(Math.min(...e),Math.max(...t))}const v=(y.length?Math.min(...y):0)-1,b=(y.length?Math.max(...y):10)+1,g=r(0,2*Math.PI,180),_=r(v,b,300),w=[],x=[],j=[];for(let e=0;e<g.length;e++){const t=g[e],n=[],o=[],r=[];for(let e=0;e<_.length;e++){const s=_[e];n.push(s),o.push(a*Math.cos(t)),r.push(a*Math.sin(t))}w.push(n),x.push(o),j.push(r)}const M=r(v,b,250),S=M.map((()=>0)),k=M.map((()=>a)),P=M.map((()=>-a)),O=[];O.push({type:"surface",x:w,y:x,z:j,opacity:.2,colorscale:"Greys",showscale:!1,name:"Pipe Surface"}),O.push({type:"scatter3d",mode:"markers",x:h,y:f,z:m,marker:{size:4},name:"Anomaly Points"}),O.push({type:"scatter3d",mode:"lines",x:M,y:S,z:k,line:{width:5},name:"Top (12 o'clock)"}),O.push({type:"scatter3d",mode:"lines",x:M,y:S,z:P,line:{width:5},name:"Bottom (6 o'clock)"});const T=l*Math.PI/180;for(const[e,t]of d){const n=r(0,2*Math.PI,360),o=n.map((()=>e)),s=n.map((e=>a*Math.cos(e))),i=n.map((e=>a*Math.sin(e)));O.push({type:"scatter3d",mode:"lines",x:o,y:s,z:i,line:{color:"orange",width:4},name:`Ring: ${t}`,showlegend:!0});const l=a*u*Math.cos(T),c=a*u*Math.sin(T);O.push({type:"scatter3d",mode:"text",x:[e],y:[l],z:[c],text:[t],textfont:{size:12,color:"orange"},showlegend:!1})}if(e.show_sw&&p.length)for(const[e,t,n]of p){const o=r(e,t,120),s=r(0,Math.PI,120),l=a+i,u=[],c=[],d=[],p=[],h=[];for(let e=0;e<s.length;e++){const t=s[e],n=[],r=[],i=[],f=[],m=[];for(let e=0;e<o.length;e++)n.push(o[e]),r.push(a*Math.cos(t)),i.push(a*Math.sin(t)),f.push(l*Math.cos(t)),m.push(l*Math.sin(t));u.push(n),c.push(r),d.push(i),p.push(f),h.push(m)}O.push({type:"surface",x:u,y:c,z:d,colorscale:"Greens",opacity:.75,showscale:!1,name:`Sleeve (inner): ${n}`}),O.push({type:"surface",x:u,y:p,z:h,colorscale:"Greens",opacity:.75,showscale:!1,name:`Sleeve (outer): ${n}`});const f=(e+t)/2;O.push({type:"scatter3d",mode:"text",x:[f],y:[0],z:[1.1*(a+i)],text:[n],textfont:{size:12,color:"darkgreen"},showlegend:!1})}return{traces:O,layout:{title:o,margin:{l:0,r:0,b:0,t:50},scene:{xaxis:{title:"Distance along pipeline (m)",range:[v,b]},aspectmode:"data"},scene_camera:(null===(n=e.camera)||void 0===n?void 0:n.eye)?{eye:e.camera.eye}:{eye:{x:1.6,y:1.6,z:.8}}}}}(e);yield n.react(i.current,o,a,{responsive:!0,displaylogo:!1})}))}return e.React.useEffect((()=>{_({schemaVersion:1,title:"Demo (Fallback)",show_sw:!1,sw_name:"Swamp Weight",radius:1,sw_thickness:.15,label_angle_deg:90,label_offset_factor:1.15,data:[[216568.488,"01:21"],[216568.489,"01:50"],[216568.49,"03:38"],[216568.493,"12:31"],[216568.494,"11:04"]],data_gw:[[216568.606,"RGWD 145820"]],data_sw:[],camera:{eye:{x:1.6,y:1.6,z:.8}}}).catch(console.error)}),[]),(0,e.jsx)("div",{style:{padding:10,width:"100%",height:"100%",overflow:"hidden"}},(0,e.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"}},(0,e.jsx)("label",null,"LS:\xa0",(0,e.jsx)("input",{value:u,onChange:e=>c(e.target.value),style:{width:160}})),(0,e.jsx)("label",null,"Weld:\xa0",(0,e.jsx)("input",{value:d,onChange:e=>p(e.target.value),style:{width:160}})),(0,e.jsx)("label",null,"Extent(m):\xa0",(0,e.jsx)("input",{value:h,onChange:e=>f(e.target.value),style:{width:90}})),(0,e.jsx)("button",{onClick:function(){return t(this,void 0,void 0,(function*(){var e;try{b(""),y("running");const e=yield function(e,n){return t(this,void 0,void 0,(function*(){var t,r,s;const{loadArcGISJSAPIModules:a}=yield Promise.resolve().then(l.bind(l,686)),[i]=yield a(["esri/request"]),u=yield i(`${e}/submitJob`,{method:"post",query:{f:"json",ls_number:null!==(t=n.ls_number)&&void 0!==t?t:"",weld_number:null!==(r=n.weld_number)&&void 0!==r?r:"",extent_m:null!==(s=n.extent_m)&&void 0!==s?s:""},responseType:"json"}),c=null==u?void 0:u.data,d=null==c?void 0:c.jobId;if(!d)throw new Error(`submitJob failed: ${JSON.stringify(c)}`);const p=`${e}/jobs/${d}`;for(let e=0;e<60;e++){const t=yield i(p,{method:"get",query:{f:"json"},responseType:"json"}),n=null==t?void 0:t.data,r=null==n?void 0:n.jobStatus;if("esriJobSucceeded"===r)break;if("esriJobFailed"===r||"esriJobTimedOut"===r||"esriJobCancelled"===r)throw new Error(`Job failed: ${JSON.stringify(n)}`);if(yield o(1e3),59===e)throw new Error("Job timeout (waited ~60s)")}const h=yield i(`${p}/results/result_json`,{method:"get",query:{f:"json"},responseType:"json"}),f=null==h?void 0:h.data,m=null==f?void 0:f.value;if("string"!=typeof m||0===m.trim().length)throw new Error(`Empty/invalid result_json: ${JSON.stringify(f)}`);return JSON.parse(m)}))}(n,{ls_number:u,weld_number:d,extent_m:h});yield _(e),y("success")}catch(t){console.error(t),b(null!==(e=null==t?void 0:t.message)&&void 0!==e?e:String(t)),y("failed")}}))},disabled:"running"===m},"running"===m?"Running...":"Run Web Tool"),(0,e.jsx)("div",{style:{marginLeft:8}},"Status:\xa0",(0,e.jsx)("b",null,m))),v?(0,e.jsx)("div",{style:{color:"red",marginTop:8}},"Error: ",v):null,(0,e.jsx)("div",{ref:i,style:{width:"100%",height:"calc(100% - 70px)",marginTop:10,border:"1px solid rgba(0,0,0,0.15)"}}))}function i(e){l.p=e}})(),u})())}}}));